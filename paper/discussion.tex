\section{Discussion}
\label{sec:discussion}
\textbf{Implications of weak Tor keys} \textcolor{red}{We were able compute NUM private keys. Discuss how. Implications of factorable RSA signing keys in Tor relay servers are serious. Discuss in greater detail. We have developed pipeline that helps Tor developers detect weak Tor keys. Code is publically available. Put in link after cleaning up the code.}

\textbf{Tor keys with non-standard exponents} Recall that the Tor reference implementation hard-codes its public RSA exponent
to 65,537~\cite[\S~0.3]{torspec}.  The Tor Project could prevent non-standard
exponents by having the directory authorities reject relays whose descriptors
have an RSA exponent other than 65,537, thus slowing down the search for
fingerprint prefixes.  Adversaries would then have to iterate over the primes
$p$ or $q$ instead of the exponent, making the search more expensive.  Given
that we discovered only 122 unusual exponents in over ten years, we believe that
rejecting non-standard exponents is a viable defense in depth.

Future work should shed light on the public keys of onion services.  Onion
services have an incentive to modify their fingerprints to make them both
recognizable and easier to remember.  Facebook, for example, was lucky enough to
obtain the easy-to-remember name \url{facebookcorewwwi.onion}~\cite{facebook}.
The tool Scallion assists onion service operators in creating such vanity
domains~\cite{scallion}.  It remains an open question whether vanity domains
benefit usability, harm security, or a combination
thereof~\cite{vanity-domains}.  Unlike the public keys of relays, onion service
keys are not archived, so a study would have to begin with actively fetching
onion service keys.

\textbf{\textit{in vivo} Tor Research} For the purposes of completeness, we feel compelled to mention \textcolor{red}{wording}. The continued robustness of Tor against potential attackers can be partly attributed to the small army of academic researchers who have \textcolor{red}{wording}. For this reason, the Tor project welcomes academic research that helps expose unknown vulnerabilities in its anonymity system \cite{torresearch}. However, caution must be taken when conducting research \textit{in vivo}, that is, when conducting research using the live Tor network. In Section 5.1, we showed how a small mistake in key generation led to many weak keys in the Tor network. In order to help keep researchers and users safe, The Tor Project has recently launched a research safety board whose aim is to assist researchers in safely conducting Tor measurement studies \cite{vanity-domains}, e.g. by running experiments in private Tor networks that are controlled by the researchers, or by using network simulators such as Shadow \cite{stem}.
